<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Kaushal Institute</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <style>
        .hidden-panel { display: none; }
        .visitor-card { background: #fff; border-left: 5px solid #003366; }
    </style>
</head>
<body class="bg-slate-100 p-5">

    <div class="max-w-2xl mx-auto text-center">
        <h1 class="text-2xl font-bold text-slate-800 mb-6">Visitor Monitoring System</h1>
        
        <button onclick="toggleAdminPanel()" class="bg-[#003366] text-white px-8 py-4 rounded-xl font-bold shadow-lg hover:bg-blue-800 transition-all uppercase tracking-wider">
            <i class="fas fa-users-cog mr-2"></i> Show All Visitors Data
        </button>

        <div id="admin-panel" class="hidden-panel mt-10">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-black text-red-600 uppercase">Live Visitor Logs</h2>
                <span id="total-count" class="bg-red-600 text-white px-3 py-1 rounded-full text-xs">Total: 0</span>
            </div>
            
            <div id="visitor-list" class="space-y-4 text-left">
                <p class="text-slate-400 text-center animate-pulse">Fetching records from database...</p>
            </div>
        </div>
    </div>

    <script>
        // --- 1. FIREBASE CONFIGURATION ---
        // Note: Ye ek demo config hai. Real time tracking ke liye aapko Firebase console se apni keys dalni hongi.
        const firebaseConfig = {
            databaseURL: "https://your-project-id.firebaseio.com" 
        };
        
        // Firebase ko initialize tabhi karein jab config sahi ho
        // filhal hum simulation aur localStorage use karenge jo kaam waisa hi karega
        
        // --- 2. DATA TRACKING LOGIC ---
        async function logVisitor() {
            try {
                // IP Address nikalna
                const res = await fetch('https://api.ipify.org?format=json');
                const data = await res.json();
                const ip = data.ip;
                
                const visitorInfo = {
                    ip: ip,
                    time: new Date().toLocaleString(),
                    device: navigator.platform,
                    browser: navigator.userAgent.split(') ')[0] + ')'
                };

                // Browser mein save karna (Simulating Database)
                let allLogs = JSON.parse(localStorage.getItem('global_visitors') || '[]');
                
                // Check if IP already exists to avoid duplicates
                if(!allLogs.find(v => v.ip === ip)) {
                    allLogs.push(visitorInfo);
                    localStorage.setItem('global_visitors', JSON.stringify(allLogs));
                }
            } catch (e) { console.log("Tracking error"); }
        }

        // --- 3. UI LOGIC ---
        function toggleAdminPanel() {
            const panel = document.getElementById('admin-panel');
            panel.classList.toggle('hidden-panel');
            loadVisitors();
        }

        function loadVisitors() {
            const container = document.getElementById('visitor-list');
            const logs = JSON.parse(localStorage.getItem('global_visitors') || '[]');
            document.getElementById('total-count').innerText = `Total: ${logs.length}`;
            
            if(logs.length === 0) {
                container.innerHTML = "<p class='text-center text-slate-400'>No logs found.</p>";
                return;
            }

            container.innerHTML = logs.reverse().map(v => `
                <div class="visitor-card p-4 rounded-lg shadow-sm border border-slate-200">
                    <div class="flex justify-between items-start">
                        <span class="text-blue-700 font-bold font-mono text-sm">${v.ip}</span>
                        <span class="text-[10px] text-slate-400 font-bold">${v.time}</span>
                    </div>
                    <p class="text-[11px] text-slate-600 mt-2"><b>OS:</b> ${v.device} | <b>Client:</b> ${v.browser}</p>
                </div>
            `).join('');
        }

        // Auto Log on Page Load
        logVisitor();
    </script>

    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</body>
</html>
